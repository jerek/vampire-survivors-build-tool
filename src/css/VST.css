/**
 * Styles for Jerek Dain's Vampire Survivors Tools.
 */

/* ********************* */
/* ***** VARIABLES ***** */
/* ********************* */

:root {
    /* Values from the game, or that closely mimic the game. */
    --vs-blue: #4b4f74;
    --vs-button-border-size: 18;
    --vs-button-border-size-px: 18px;
    --vs-generic-border-size: 5;
    --vs-generic-border-size-px: 5px;
    --vs-char-weapon-frame-size: 42px;
    --vs-char-weapon-frame-size-x2: 84px;
    --vs-char-weapon-frame-size-x3: 126px;
    --vs-shadow: 2px 2px 5px #000;
    --vs-yellow: #fc6;

    /* Non-game variables. */
    --build-tool-margin: 50px;
    --page-padding: 20px;
}

/* ********************** */
/* ***** ANIMATIONS ***** */
/* ********************** */

@keyframes actionError {
    0% {filter: sepia(100%) brightness(50%) saturate(500%) hue-rotate(290deg)}
    33% {filter: sepia(100%) brightness(50%) saturate(500%) hue-rotate(290deg)}
    34% {filter: none}
    65% {filter: none}
    66% {filter: sepia(100%) brightness(50%) saturate(500%) hue-rotate(290deg)}
    100% {filter: sepia(100%) brightness(50%) saturate(500%) hue-rotate(290deg)}
}

@keyframes fadeIn {
    0% {opacity: 0}
    100% {opacity: 1}
}

/* *************************** */
/* ***** GLOBAL ELEMENTS ***** */
/* *************************** */

/* Pixelate all scaled images. */
/* noinspection CssOverwrittenProperties */
* {image-rendering: crisp-edges; image-rendering: pixelated}

html, body {
    color: #ddd;
    /* The fallbacks look better, but Courier New is what the actual game uses. */
    font: 16px "Courier New", "JetBrains Mono", Consolas, "Bitstream Vera Sans Mono", monospace;
    margin: 0;
    min-height: 100%;
    padding: 0;
}
/* A gradient that imitates the BG a little: linear-gradient(180deg, #800106 0%, #120303 100%) */
html {background: #4a0106 url(../game-assets/img/introBG.png) top / cover fixed}
body {padding: var(--page-padding)}

h1, h2, h3, h4, h5, h6 {font-weight: normal; margin: 10px 0; text-align: center}
h1 {font-size: 3em}
h2 {font-size: 2.5em}
h3 {font-size: 2em}
h4 {font-size: 1.7em}
h5 {font-size: 1.4em}
h6 {font-size: 1.2em}

h1 {
    color: var(--vs-yellow);
    font-family: serif;
    font-weight: normal;
    margin: 0 0 var(--page-padding);
    text-shadow: var(--vs-shadow);
    text-transform: uppercase;
}

a {color: var(--vs-yellow); text-decoration: none}
a:hover {color: #fff}
a:focus-visible {outline: none; text-decoration: underline}

/* ********************** */
/* ***** THE FOOTER ***** */
/* ********************** */

footer {
    color: #808080;
    font-size: 10px;
    font-weight: bold;
    margin: var(--page-padding) 0 0;
    text-align: center;
}
footer a {color: inherit; text-decoration: underline}
footer a:focus-visible {color: #fff}
footer a:hover {color: var(--vs-yellow)}

/* ************************* */
/* ***** SPRITE IMAGES ***** */
/* ************************* */

.vs-sprite-image-wrapper {align-items: flex-end; display: flex; justify-content: flex-end}
.vs-sprite-image {display: inline-block}

/* ******************* */
/* ***** BUTTONS ***** */
/* ******************* */

/* ======= */
/* GENERAL */
/* ======= */

.vs-button {
    border: var(--vs-button-border-size-px) solid transparent;
    box-sizing: border-box;
    color: #fff;
    display: inline-block;
    font-size: 16px;
    font-weight: normal;
    text-decoration: none;
    text-transform: uppercase;
}
.vs-button:focus-visible {border-radius: 8px; box-shadow: 0 0 0 2px #000; outline: none; text-decoration: none}

/* ====== */
/* COLORS */
/* ====== */

.vs-button[data-color="blue"] {
    border-image: url(../game-assets/img/UI/button_c9_normal_x2.png) var(--vs-button-border-size) fill;
}
.vs-button[data-color="blue"]:hover {
    border-image: url(../game-assets/img/UI/button_c9_mouseover_x2.png) var(--vs-button-border-size) fill;
}
.vs-button[data-color="blue"]:active {
    border-image: url(../game-assets/img/UI/button_c9_pressed_x2.png) var(--vs-button-border-size) fill;
}

.vs-button[data-color="green"] {
    border-image: url(../game-assets/img/UI/button_c5_normal_x2.png) var(--vs-button-border-size) fill;
}
.vs-button[data-color="green"]:hover {
    border-image: url(../game-assets/img/UI/button_c5_mouseover_x2.png) var(--vs-button-border-size) fill;
}
.vs-button[data-color="green"]:active {
    border-image: url(../game-assets/img/UI/button_c5_pressed_x2.png) var(--vs-button-border-size) fill;
}

.vs-button[data-color="red"] {
    border-image: url(../game-assets/img/UI/button_c8_normal_x2.png) var(--vs-button-border-size) fill;
}

/* ====== */
/* STYLES */
/* ====== */

.vs-button[data-style="default-case"] {text-transform: none}

.vs-button[data-style="small"] {font-size: 12px; line-height: 0; text-transform: none}

/* ============ */
/* BUTTON LISTS */
/* ============ */

.vs-button-list {
    align-items: center;
    display: flex;
    flex-direction: column;
    margin: 50px 0 !important; /* To override :last-child margin removal. */
}

.vs-button-list .vs-button {min-width: 180px; text-align: center}
.vs-button-list .vs-button[data-style="small"] {min-width: 130px}
.vs-button-list > :not(:first-child) {margin-top: 20px}

.vs-button-list[data-context="nav"] {align-items: flex-start; flex-direction: row; margin: 0 !important}

/* ****************** */
/* ***** LAYOUT ***** */
/* ****************** */

.vst {
    background: var(--vs-blue);
    box-sizing: border-box;
    margin: 0 auto;
    padding: 10px;
    position: relative;
    width: 700px;
}

.vst:before {
    --border-offset: -4px;
    border: 15px solid transparent;
    border-image: url(../game-assets/img/UI/frame5_c4.png) 15 fill;
    bottom: var(--border-offset);
    content: "";
    display: block;
    left: var(--border-offset);
    position: absolute;
    right: var(--border-offset);
    top: var(--border-offset);
    z-index: 1;
}

.vst-container {position: relative; z-index: 2}
.vst-container > h2:first-child {margin-top: 0}
.vst-container > :last-child {margin-bottom: 0}

/* ******************** */
/* ***** TOOLTIPS ***** */
/* ******************** */

.vst-tooltip {
    bottom: 100%;
    box-sizing: border-box;
    cursor: default;
    display: none;
    font-size: 12px;
    font-weight: bold;
    height: auto;
    left: 0;
    min-width: 175px;
    padding: 7px 8px;
    pointer-events: none;
    position: absolute;
    width: auto;
    z-index: 100;
}

.vs-arcana-card, .vs-character, .vs-item, .vs-stage {display: inline-block; position: relative}

.vs-arcana-card:hover .vst-tooltip,
.vs-character:hover .vst-tooltip,
.vs-item:hover .vst-tooltip,
.vs-stage:hover .vst-tooltip {
    display: block;
}

.vst-tooltip:after {
    border: var(--vs-generic-border-size-px) solid transparent;
    border-image: url(../game-assets/img/UI/frame1_c4.png) var(--vs-generic-border-size) fill;
    bottom: 0;
    content: "";
    display: block;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    z-index: -1;
}

/* ********************** */
/* ***** CHARACTERS ***** */
/* ********************** */

.vs-char-box {
    color: #fff;
    display: block;
    font-size: 12px;
    font-weight: bold;
    height: 96px;
    position: relative;
    width: 96px;
}
a.vs-char-box {cursor: pointer}
a.vs-char-box:hover:after,
a.vs-char-box:focus-visible:after {
    /* The selection indicators in the corners. */
    --border-size: 7;
    --border-size-px: 12px;
    --offset: -6px;
    border: var(--border-size-px) solid transparent;
    border-image: url(../game-assets/img/UI/selectionSquareActive_01.png) var(--border-size) fill;
    bottom: var(--offset);
    content: "";
    display: block;
    left: var(--offset);
    pointer-events: none;
    position: absolute;
    right: var(--offset);
    top: var(--offset);
}
.vs-char-box > * {position: absolute}
.vs-char-box-bg {
    border: var(--vs-generic-border-size-px) solid transparent;
    border-image: url(../game-assets/img/UI/frame1_c2.png) var(--vs-generic-border-size) fill;
    bottom: 0;
    left: 0;
    pointer-events: none;
    right: 0;
    top: 0;
}
.vs-char-box-name {
    left: 6px;
    text-shadow: 1px 1px 1px #8b8b8b;
    top: 5px;
    z-index: 1;
}
/* At 159px width every character perfectly matches the in-game text, except for Arca, who needs 158px. It's not set to
 * 158px for everyone because then Smith & Red Death would be wrong. */
.vs-char-box-description {left: 120px; top: 37px; width: 159px}
.vs-char-box[data-character="5"] .vs-char-box-description {width: 158px} /* Arca Ladonna */
.vs-char-box[data-character="21"] .vs-char-box-description {width: 166px} /* Sir Ambrojoe */
.vs-char-box-image {bottom: 5px; left: 6px; pointer-events: none}
.vs-char-box-weapons {
    align-content: flex-end;
    bottom: 11px;
    display: flex;
    filter: drop-shadow(3px 3px 0 #000);
    flex-direction: column;
    flex-wrap: wrap;
    justify-content: flex-end;
    right: 11px;
    top: 0;
}
.vs-item {display: block}
.vs-item[data-mode="default"] {display: contents}
.vs-item:not([data-mode="default"]) {position: relative}
.vs-item:not([data-mode="default"]) .vs-item-image {position: absolute}
.vs-char-box-weapons[data-count="2"] .vs-item-image {margin: 2px 0 0 2px}
.vs-char-box-button {bottom: 7px; position: absolute; right: 7px}

/* ============= */
/* MODE: DEFAULT */
/* ============= */

.vs-char-box[data-mode="default"] > .vs-char-box-name span {display: none}
.vs-char-box[data-mode="default"] > .vs-char-box-description {display: none}

/* ============= */
/* MODE: DETAILS */
/* ============= */

.vs-char-box[data-mode="details"] {height: 100px; width: 400px}
.vs-char-box[data-mode="details"] > .vs-char-box-weapons {
    bottom: 7px;
    filter: none;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    left: 70px;
    right: auto;
    transform-origin: bottom;
    width: var(--vs-char-weapon-frame-size);
}

/**
 * We already have Pugnala who starts with two weapons, so these styles are in preparation of up to 6 starting weapons.
 */
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="2"] {
    transform: scale(.85);
}
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="3"],
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="4"] {
    left: 40px;
    transform: scale(.7);
    width: var(--vs-char-weapon-frame-size-x2);
}
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="5"],
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="6"] {
    left: 40px;
    transform: scale(.58);
    width: var(--vs-char-weapon-frame-size-x2);
}
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="3"] > :first-child,
.vs-char-box[data-mode="details"] > .vs-char-box-weapons[data-count="5"] > :first-child {
    /* noinspection CssNonIntegerLengthInPixels */
    flex: 0 0 42.1px;
}

/* ============= */
/* MODE: TOOLTIP */
/* ============= */

.vs-char-box[data-mode="tooltip"] {
    bottom: 100%;
    cursor: default;
    display: none;
    height: auto;
    left: 0;
    pointer-events: none;
    position: absolute;
    width: auto;
    z-index: 100;
}
.vs-char-box:hover .vs-char-box[data-mode="tooltip"][data-has-description="true"],
.vs-char-box:focus-visible .vs-char-box[data-mode="tooltip"][data-has-description="true"] {
    display: block;
}

.vs-char-box[data-mode="tooltip"] > * {display: none}
.vs-char-box[data-mode="tooltip"] > .vs-char-box-description {display: block; margin: 7px 8px; position: static}
.vs-char-box[data-mode="tooltip"] > .vs-char-box-bg {
    /* TODO: IF this included the name, we'd change the text shadow to this color, to match the BG. Save for later. */
    /* .vs-char-box[data-mode="tooltip"] > .vs-char-box-name {text-shadow: 1px 1px 1px #4b4f74} */

    border-image: url(../game-assets/img/UI/frame1_c4.png) var(--vs-generic-border-size) fill;
    display: block;
    z-index: -1;
}

/* ***************** */
/* ***** ITEMS ***** */
/* ***************** */

.vs-item[data-mode="frame"], .vst-build-selected-items-item:empty {
    background: url(../game-assets/img/UI/frameB.png) center / 100% 100%;
    height: var(--vs-char-weapon-frame-size);
    width: var(--vs-char-weapon-frame-size);
}

/* ****************** */
/* ***** BUILDS ***** */
/* ****************** */

/* Hide section headings when their data has been selected. */
body[data-page="build"] .vst-container > section[data-selected="true"] > h2 {
    display: none;
}

body[data-page="build"] section {margin: 10px 0; transition: margin 150ms}
body[data-page="build"] section:not([data-selected="true"]) {margin: 50px 0}
body[data-page="build"] section:not([data-section="character"]) h2 {margin: 0}
section[data-section="character"] {display: block; margin-top: var(--build-tool-margin) !important}
section[data-section="character"][data-selected="true"] ~ section:last-child {
    margin-bottom: var(--build-tool-margin) !important;
}

/* Sections other than characters are hidden until a character is selected. */
section[data-section="character"]:not([data-selected="true"]) ~ section {display: none}

/* ***************************** */
/* ***** BUILDS: CHARACTER ***** */
/* ***************************** */

.vst-build-character-list {display: flex; flex-wrap: wrap; justify-content: center; padding-bottom: 20px}
section[data-section="character"] .vs-char-box[data-mode="default"] {margin: 5px}
section[data-section="character"] .vst-build-selected-character {display: none}
section[data-section="character"] .vst-build-selected-character .vs-char-box {margin: 0 auto}
section[data-section="character"][data-selected="true"] .vst-build-character-list {display: none}
section[data-section="character"][data-selected="true"] .vst-build-selected-character {display: block}

/* ************************* */
/* ***** BUILDS: ITEMS ***** */
/* ************************* */

/* ======== */
/* SELECTED */
/* ======== */

/* ------- */
/* GENERAL */
/* ------- */

.vst-build-selected-items {display: flex; flex-wrap: wrap; justify-content: center}
.vst-build-selected-items-item {height: 42.6666px !important; margin: 2px; width: 42.6666px !important}
.vst-build-selected-items .vs-item-image {animation: fadeIn 150ms}
.vst-build-selected-items-item:not(:empty) {cursor: pointer}

/* --------------- */
/* EQUIPPED FRAMES */
/* --------------- */

.vst-build-selected-weapons .vs-item[data-mode="equipped"],
.vst-build-selected-weapons .vst-build-selected-items-item:empty {
    background: url(../game-assets/img/UI/weaponBG.png) no-repeat center / 38px 38px;
}
.vst-build-selected-passives .vs-item[data-mode="equipped"],
.vst-build-selected-passives .vst-build-selected-items-item:empty {
    background: url(../game-assets/img/UI/passiveBG.png) no-repeat center / 38px 38px;
}

/* ==== */
/* LIST */
/* ==== */

section[data-selected="true"] .vst-build-items-list {display: none}
.vst-build-items-list {display: flex; flex-wrap: wrap; justify-content: center}
.vst-build-items-list .vs-item {margin: 2px; position: relative; transition: opacity 150ms, filter 150ms}
.vst-build-items-list .vs-item[data-selected="true"] {opacity: .5}
.vst-build-items-list .vs-item[data-selected="true"] * {filter: grayscale(1) brightness(0.65)}
.vst-build-items-list .vs-item:after {
    /* The selection indicators in the corners. */
    --border-size: 7;
    --border-size-px: 12px;
    --offset: -2px;
    border: var(--border-size-px) solid transparent;
    border-image: url(../game-assets/img/UI/selectionSquareActive_01.png) var(--border-size) fill;
    bottom: var(--offset);
    content: "";
    display: block;
    left: var(--offset);
    opacity: 0;
    pointer-events: none;
    position: absolute;
    right: var(--offset);
    top: var(--offset);
    transition: 150ms;
}
.vst-build-items-list .vs-item[data-selected="true"]:after {opacity: 1}
.vst-build-items-list .vs-item[data-animation="error"] {animation: actionError 300ms}
